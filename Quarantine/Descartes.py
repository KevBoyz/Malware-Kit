# I'm a file? A dream?
# I really exist?
# Your files are now going through an existential crisis.
# This code encrypts everything he finds along the way.
# Remember to use a good password.

from os import walk
from os.path import join
from itertools import count


def read_file(file_path):
    with open(file_path, 'rb') as file:
        return bytearray(file.read())


def cryptograph(file_path, file_content, passw):
    with open(file_path, 'wb') as file:
        encode = bytearray()
        for i, b in enumerate(file_content):
            passw_index = i % len(passw)
            encode.append(b ^ ord(passw[passw_index]))
        file.write(encode)


print(r"""
 ______                                        _                 
|_   _ `.                                     / |_               
  | | `. \ .---.  .--.   .---.  ,--.   _ .--.`| |-'.---.  .--.   
  | |  | |/ /__\\( (`\] / /'`\]`'_\ : [ `/'`\]| | / /__\\( (`\]  
 _| |_.' /| \__., `'.'. | \__. // | |, | |    | |,| \__., `'.'.  
|______.'  '.__.'[\__) )'.___.'\'-;__/[___]   \__/ '.__.'[\__) ) 
                                                                    1.1 by KevBoyz
                                                                    
""")
password = str(input('Password: '))
c = count()

for folder, sub_folders, files in walk('.'):
    for file in files:
        if file != 'Descartes.py':
            try:
                path = join(folder, file)
                content = read_file(path)
                cryptograph(path, content, password)
                print(f'{file} done')
                next(c)
            except Exception as e:
                print(f'{e} at {file}')
print(f'Process finished. {c} encrypted files')
